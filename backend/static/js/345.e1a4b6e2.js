"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[345],{8345:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var l=a(6768),o=a(4232),n=a(5130);const s={id:"supervisor-leads",class:"container mt-4"},r={class:"text-center mb-4"},d={class:"chart-container mb-4 d-flex justify-content-center"},i={class:"controls d-flex justify-content-between align-items-center mb-4"},u={class:"totalizadores"},c={class:"navigation-buttons text-center mt-4"},L={key:0,class:"filtros mb-4 row g-3"},h={class:"col-md-4"},v=["value"],p={class:"col-md-4"},k={class:"col-md-4"},m={key:1,class:"table-responsive"},f={class:"table table-bordered table-striped"};function g(e,t,a,g,b,C){const E=(0,l.g2)("v-chart"),_=(0,l.g2)("BotonesGlobales");return(0,l.uX)(),(0,l.CE)("div",s,[t[24]||(t[24]=(0,l.Lk)("h1",{class:"text-center mb-4"},"Reporte de Leads",-1)),(0,l.Lk)("div",r,[(0,l.Lk)("button",{class:"btn btn-secondary",onClick:t[0]||(t[0]=(...e)=>C.generarContenidoTabla&&C.generarContenidoTabla(...e))},"Generar Contenido Tabla")]),(0,l.Lk)("div",d,[(0,l.bF)(E,{option:b.chartOptions,style:{width:"100%",height:"350px"}},null,8,["option"])]),(0,l.Lk)("div",i,[(0,l.Lk)("div",null,[(0,l.Lk)("button",{class:"btn btn-success me-2",onClick:t[1]||(t[1]=e=>C.exportarReporte("pdf"))},"Exportar PDF"),(0,l.Lk)("button",{class:"btn btn-info",onClick:t[2]||(t[2]=e=>C.exportarReporte("csv"))},"Exportar CSV")]),(0,l.Lk)("div",u,[(0,l.Lk)("p",null,[t[9]||(t[9]=(0,l.eW)("Total leads en sistema: ")),(0,l.Lk)("strong",null,(0,o.v_)(b.totalLeadsAsignados),1)]),(0,l.Lk)("p",null,[t[10]||(t[10]=(0,l.eW)("Total leads Nuevos: ")),(0,l.Lk)("strong",null,(0,o.v_)(b.totalLeadsNuevos),1)]),(0,l.Lk)("p",null,[t[11]||(t[11]=(0,l.eW)("Total leads en seguimiento: ")),(0,l.Lk)("strong",null,(0,o.v_)(b.totalLeadsEnSeguimiento),1)]),(0,l.Lk)("p",null,[t[12]||(t[12]=(0,l.eW)("Total leads cerrados: ")),(0,l.Lk)("strong",null,(0,o.v_)(b.totalLeadsCerrados),1)]),(0,l.Lk)("p",null,[t[13]||(t[13]=(0,l.eW)("Total leads culminados en venta: ")),(0,l.Lk)("strong",null,(0,o.v_)(b.totalLeadsCulminadosEnVenta),1)]),(0,l.Lk)("p",null,[t[14]||(t[14]=(0,l.eW)("Total leads asignados: ")),(0,l.Lk)("strong",null,(0,o.v_)(b.totalLeadsAsignadosEstado),1)]),(0,l.Lk)("p",null,[t[15]||(t[15]=(0,l.eW)("Última conexión del vendedor: ")),(0,l.Lk)("strong",null,(0,o.v_)(C.formatearFecha(b.tiempoUltimaConexion)),1)]),(0,l.Lk)("p",null,[t[16]||(t[16]=(0,l.eW)("Última puesta en línea: ")),(0,l.Lk)("strong",null,(0,o.v_)(C.formatearFecha(b.ultimaPuestaOnline)),1)])])]),(0,l.Lk)("div",c,[(0,l.bF)(_)]),b.contenidoGenerado?((0,l.uX)(),(0,l.CE)("div",L,[(0,l.Lk)("div",h,[t[18]||(t[18]=(0,l.Lk)("label",{class:"form-label"},"Filtrar por vendedor:",-1)),(0,l.bo)((0,l.Lk)("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=e=>b.filtroVendedor=e),onChange:t[4]||(t[4]=(...e)=>C.filtrarLeads&&C.filtrarLeads(...e))},[t[17]||(t[17]=(0,l.Lk)("option",{value:""},"Todos",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.vendedores,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.id,value:e.id},(0,o.v_)(e.nombre),9,v)))),128))],544),[[n.u1,b.filtroVendedor]])]),(0,l.Lk)("div",p,[t[20]||(t[20]=(0,l.Lk)("label",{class:"form-label"},"Filtrar por estado:",-1)),(0,l.bo)((0,l.Lk)("select",{class:"form-select","onUpdate:modelValue":t[5]||(t[5]=e=>b.filtroEstado=e),onChange:t[6]||(t[6]=(...e)=>C.filtrarLeads&&C.filtrarLeads(...e))},t[19]||(t[19]=[(0,l.Fv)('<option value="" data-v-62eb74d8>Todos</option><option value="nuevo" data-v-62eb74d8>Nuevo</option><option value="asignado" data-v-62eb74d8>Asignado</option><option value="en seguimiento" data-v-62eb74d8>En Seguimiento</option><option value="cerrado" data-v-62eb74d8>Cerrado</option><option value="culmina en venta" data-v-62eb74d8>Culmina en Venta</option>',6)]),544),[[n.u1,b.filtroEstado]])]),(0,l.Lk)("div",k,[t[22]||(t[22]=(0,l.Lk)("label",{class:"form-label"},"Filtrar por Test Drive:",-1)),(0,l.bo)((0,l.Lk)("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=e=>b.filtroTestDrive=e),onChange:t[8]||(t[8]=(...e)=>C.filtrarLeads&&C.filtrarLeads(...e))},t[21]||(t[21]=[(0,l.Lk)("option",{value:""},"Todos",-1),(0,l.Lk)("option",{value:"Si"},"Si",-1),(0,l.Lk)("option",{value:"No"},"No",-1)]),544),[[n.u1,b.filtroTestDrive]])])])):(0,l.Q3)("",!0),b.contenidoGenerado?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("table",f,[t[23]||(t[23]=(0,l.Lk)("thead",{class:"table-dark"},[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"Nombres"),(0,l.Lk)("th",null,"Apellidos"),(0,l.Lk)("th",null,"Identificación"),(0,l.Lk)("th",null,"Teléfono"),(0,l.Lk)("th",null,"Dirección"),(0,l.Lk)("th",null,"Ciudad"),(0,l.Lk)("th",null,"Correo"),(0,l.Lk)("th",null,"Fecha Lead"),(0,l.Lk)("th",null,"Origen Lead"),(0,l.Lk)("th",null,"Marca de Interés"),(0,l.Lk)("th",null,"Modelo Interesado"),(0,l.Lk)("th",null,"Estatus"),(0,l.Lk)("th",null,"Test Drive"),(0,l.Lk)("th",null,"Seguimientos")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.leadsFiltrados,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.nombres),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.apellidos),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.identificacion),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.telefono),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.direccion),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.ciudad),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.correo),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(C.formatearFecha(e.fecha_lead)),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.origen_lead),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.marca_interes),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.modelo_interesado),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.estatus),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.test_drive),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,o.v_)(e.seguimientos),1)])])))),128))])])])):(0,l.Q3)("",!0)])}a(8992),a(4520),a(4603),a(7566),a(8721);var b=a(3173),C=a(7780),E=a(2212),_=a(3704),T=a(623),F=a(9536),A=a(5143),V=a(5095),x=a(6743);(0,E.Y)([T.a,F.a,A.a,_.a,V.a]);var N={components:{VChart:C.Ay,BotonesGlobales:x.A},data(){return{leads:[],leadsFiltrados:[],filtroVendedor:"",filtroEstado:"",filtroTestDrive:"",vendedores:[],totalLeadsAsignados:0,totalLeadsNuevos:0,totalLeadsEnSeguimiento:0,totalLeadsCerrados:0,totalLeadsCulminadosEnVenta:0,totalLeadsAsignadosEstado:0,tiempoUltimaConexion:"",ultimaPuestaOnline:"",contenidoGenerado:!1,chartOptions:{tooltip:{trigger:"item"},legend:{top:"bottom"},series:[{type:"funnel",left:"10%",width:"80%",sort:"descending",label:{show:!0,position:"inside"},data:[{value:this.totalLeadsAsignados,name:"En sistema"},{value:this.totalLeadsNuevos,name:"Nuevo"},{value:this.totalLeadsEnSeguimiento,name:"En seguimiento"},{value:this.totalLeadsCerrados,name:"Cerrados"},{value:this.totalLeadsCulminadosEnVenta,name:"Culminados en venta"}]}]}}},methods:{generarContenidoTabla(){this.cargarLeads(),this.contenidoGenerado=!0},formatearFecha(e){if(!e)return"N/A";const t=/^\d{4}-\d{2}-\d{2}$/;if(!t.test(e))return console.warn(`Formato de fecha no reconocido: ${e}`),e;const[a,l,o]=e.split("-");return`${o}/${l}/${a}`},cargarLeads(){b.A.get("/get-all-leads").then((e=>{this.leads=e.data,this.filtrarLeads()})).catch((e=>{console.error("Error al cargar leads:",e)}))},cargarVendedores(){b.A.get("/get-vendedores").then((e=>{this.vendedores=e.data})).catch((e=>{console.error("Error al cargar vendedores:",e)}))},filtrarLeads(){this.leadsFiltrados=this.leads.filter((e=>(!this.filtroVendedor||e.asignado_a===parseInt(this.filtroVendedor))&&(!this.filtroEstado||e.estatus===this.filtroEstado)&&(!this.filtroTestDrive||e.test_drive===this.filtroTestDrive))),this.calcularTotalizadores()},calcularTotalizadores(){this.totalLeadsAsignados=this.leadsFiltrados.length,this.totalLeadsNuevos=this.leadsFiltrados.filter((e=>"nuevo"===e.estatus)).length,this.totalLeadsEnSeguimiento=this.leadsFiltrados.filter((e=>"en seguimiento"===e.estatus)).length,this.totalLeadsCerrados=this.leadsFiltrados.filter((e=>"cerrado"===e.estatus)).length,this.totalLeadsCulminadosEnVenta=this.leadsFiltrados.filter((e=>"culmina en venta"===e.estatus)).length,this.totalLeadsAsignadosEstado=this.leadsFiltrados.filter((e=>"asignado"===e.estatus)).length,this.updateChartData(),this.filtroVendedor?b.A.get(`/tiempo-ultima-conexion?vendedor=${this.filtroVendedor}`).then((e=>{this.tiempoUltimaConexion=e.data.fecha_ultima_conexion,this.ultimaPuestaOnline=e.data.ultima_puesta_online})).catch((e=>{console.error("Error al obtener fecha desde la última conexión:",e)})):(this.tiempoUltimaConexion="N/A",this.ultimaPuestaOnline="N/A")},updateChartData(){this.chartOptions.series[0].data=[{value:this.totalLeadsAsignados,name:"En sistema"},{value:this.totalLeadsNuevos,name:"Nuevo"},{value:this.totalLeadsEnSeguimiento,name:"En seguimiento"},{value:this.totalLeadsCerrados,name:"Cerrados"},{value:this.totalLeadsCulminadosEnVenta,name:"Culminados en venta"}]},guardarLead(e){b.A.post("/update-lead",e).then((()=>{alert("Lead actualizado")})).catch((e=>{console.error("Error al guardar el lead:",e)}))},exportarReporte(e){b.A.post("/exportar-reporte",{leads:this.leadsFiltrados,vendedor:this.filtroVendedor?parseInt(this.filtroVendedor):null,filtro_estado:this.filtroEstado||null,filtroTestDrive:this.filtroTestDrive||null,formato:e},{responseType:"blob"}).then((t=>{const a=window.URL.createObjectURL(new Blob([t.data])),l=document.createElement("a");l.href=a,l.setAttribute("download",`reporte_leads.${e}`),document.body.appendChild(l),l.click(),document.body.removeChild(l)})).catch((e=>{console.error("Error al exportar reporte:",e)}))}},created(){this.cargarVendedores()}},y=a(1241);const D=(0,y.A)(N,[["render",g],["__scopeId","data-v-62eb74d8"]]);var w=D}}]);
//# sourceMappingURL=345.e1a4b6e2.js.map